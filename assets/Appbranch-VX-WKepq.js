import{X as k,r as c,j as e,o as x,p as L,x as N,i as V,B as j,I as B,Y as ee,Z as ae,J as ne,K as te,$ as re,a0 as D,s as se}from"./index-Bg9Gd-Mk.js";import{G as t,F as le,T as ie,D as oe,u as w,w as ce,E as de,a as he}from"./jspdf.plugin.autotable-C62ySDC9.js";import{T as s,I as me}from"./TextField-DrCr6fLd.js";import{A as P}from"./Autocomplete-BKTD_cRl.js";import{d as ue,T as xe,a as R,b as p,c as pe}from"./TableRow-CsweJJjp.js";import{E as be}from"./Edit-wTQG4UGA.js";import{T as je}from"./TablePagination-CgySaG-p.js";import{D as ge,a as fe,b as ve,c as Ce}from"./DialogTitle-Cild9m65.js";import{D as _e}from"./Drawer-CrLtX86L.js";import{F as Se}from"./FormControl-CEF_MUqX.js";import{S as ye}from"./Select-BTOFfGV5.js";import{M as F}from"./MenuItem-BZ0Bes1g.js";import{S as Be}from"./Stack-CbZndAYz.js";import"./useId-CblYdv6j.js";import"./utils-BOIr5jf6.js";import"./useFormControl-BIpaAVtd.js";import"./FormHelperText-cSQn0M_Y.js";import"./Input-BBa8_kQ9.js";import"./Close-BdqVTZbN.js";import"./Popper-CLxdUBp6.js";import"./useControlled-DwjBksQM.js";import"./usePreviousProps-DpKnkwRp.js";import"./Chip-Bxuv7oEj.js";import"./Toolbar-DJcYTIBb.js";import"./Slide-CQBBZdC5.js";import"./dividerClasses-DUtPGmYP.js";const De=()=>{const h=k(),[l,r]=c.useState({branch_code:"",branch_name:"",branch_email:"",branch_pin_code:"",branch_mobile:"",branch_address:""}),[m,o]=c.useState(""),g=[{label:"Option 1",value:"1"},{label:"Option 2",value:"2"},{label:"Option 3",value:"3"}],n=i=>{r({...l,[i.target.name]:i.target.value})},d=async i=>{i.preventDefault(),o("");try{const b=await V.post("http://localhost/swathi-transport/backend/api/branch/branch-api.php?action=add",l);b.data.error?o(b.data.error):(alert("Branch added successfully!"),r({branch_code:"",branch_name:"",branch_email:"",branch_pin_code:"",branch_mobile:"",branch_address:""}),h("/master/branch"))}catch(b){o("Failed to add branch. Please try again."+b)}};return e.jsxs("div",{children:[e.jsx("h2",{children:"Add Branch"}),m&&e.jsx("p",{style:{color:"red"},children:m}),e.jsxs("form",{onSubmit:d,children:[e.jsxs(t,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(t,{item:!0,md:6,xs:12,lg:3,children:e.jsx(s,{fullWidth:!0,name:"branch_code",value:l.branch_code,onChange:n,label:"Code",required:!0})}),e.jsx(t,{item:!0,md:6,xs:12,lg:3,children:e.jsx(s,{fullWidth:!0,name:"branch_name",value:l.branch_name,onChange:n,label:"Name",required:!0})}),e.jsx(t,{item:!0,md:6,xs:12,lg:3,children:e.jsx(s,{fullWidth:!0,type:"email",name:"branch_email",value:l.branch_email,onChange:n,label:"Email"})}),e.jsx(t,{item:!0,md:6,xs:12,lg:3,children:e.jsx(s,{fullWidth:!0,type:"number",name:"branch_pin_code",value:l.branch_pin_code,onChange:n,label:"Pincode",required:!0})})]}),e.jsxs(t,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(t,{item:!0,md:6,xs:12,lg:3,children:e.jsx(s,{fullWidth:!0,name:"branch_mobile",value:l.branch_mobile,onChange:n,label:"Contact",required:!0})}),e.jsx(t,{item:!0,md:6,xs:12,lg:3,children:e.jsx(P,{options:g,getOptionLabel:i=>i.label,onChange:(i,b)=>{console.log("Selected option:",b)},renderInput:i=>e.jsx(s,{...i,label:"Select State",variant:"outlined",fullWidth:!0})})}),e.jsx(t,{item:!0,md:6,xs:12,lg:3,children:e.jsx(s,{fullWidth:!0,name:"branch_address",value:l.branch_address,onChange:n,label:"Address",required:!0})})]}),e.jsxs(x,{color:"primary",variant:"contained",type:"submit",sx:{mr:2},children:[e.jsx(L,{children:"send"}),e.jsx(N,{sx:{pl:1,textTransform:"capitalize"},children:"Submit"})]}),e.jsx(x,{variant:"contained",color:"secondary",onClick:()=>h("/master/branch"),children:"Back"})]})]})};function we(){const h=k(),[l,r]=c.useState([{id:1,name:"Main Branch",address:"main@example.com",status:"Active"},{id:2,name:"West Branch",address:"west@example.com",status:"Inactive"},{id:3,name:"East Branch",address:"east@example.com",status:"Cancelled"},{id:4,name:"North Branch",address:"north@example.com",status:"Active"},{id:5,name:"South Branch",address:"south@example.com",status:"Inactive"},{id:6,name:"South Branch",address:"south@example.com",status:"Inactive"}]),[m,o]=c.useState(l),[g,n]=c.useState(0),[d,i]=c.useState(5),[b,E]=c.useState(!1),[$,T]=c.useState(!1),[f,M]=c.useState(null),[v,W]=c.useState(""),[C,I]=c.useState(""),[_,A]=c.useState("");c.useEffect(()=>{fetch("/api/branches").then(a=>a.json()).then(a=>{r(a),o(a)}).catch(()=>console.log("Using default data"))},[]);const U=(a,u)=>n(u),z=a=>{i(+a.target.value),n(0)},G=()=>T(!0),O=()=>T(!1),J=a=>{M(a),E(!0)},S=()=>{E(!1),W("")},Y=()=>{if(!v.trim())return;console.log(`Deleting branch: ${f.name} for reason: ${v}`);const a=l.filter(u=>u.id!==f.id);r(a),o(a),S()},H=()=>{let a=l;C.trim()&&(a=a.filter(u=>u.name.toLowerCase().includes(C.toLowerCase()))),_&&(a=a.filter(u=>u.status===_)),o(a),O()},K=()=>{I(""),A(""),o(l)},X=()=>{const a=w.json_to_sheet(m),u=w.book_new();w.book_append_sheet(u,a,"Branches"),ce(u,"branches.xlsx")},Z=()=>{const a=new de;a.text("Branch List",14,10);const u=["Branch","Email","Status"],Q=m.map(y=>[y.name,y.address,y.status]);he(a,{head:[u],body:Q,startY:20}),a.save("branches.pdf")};return e.jsxs(j,{children:[e.jsxs(j,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(j,{display:"flex",alignItems:"center",gap:1,children:[e.jsx("h2",{children:"Branch List"}),e.jsx(B,{color:"primary",onClick:G,children:e.jsx(le,{})})]}),e.jsxs(j,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(x,{variant:"contained",color:"primary",onClick:()=>h("add"),md:6,xs:12,lg:3,children:"Add Branch"}),e.jsx(x,{variant:"contained",color:"success",onClick:X,children:"Export to Excel"}),e.jsx(x,{variant:"contained",color:"secondary",onClick:Z,children:"Export to PDF"})]})]}),e.jsx(ie,{component:ee,children:e.jsxs(ue,{children:[e.jsx(xe,{children:e.jsxs(R,{children:[e.jsx(p,{align:"center",children:e.jsx("b",{children:"Branch"})}),e.jsx(p,{align:"center",children:e.jsx("b",{children:"Email"})}),e.jsx(p,{align:"center",children:e.jsx("b",{children:"Status"})}),e.jsx(p,{align:"center",children:e.jsx("b",{children:"Edit"})}),e.jsx(p,{align:"center",children:e.jsx("b",{children:"Delete"})})]})}),e.jsx(pe,{children:m.slice(g*d,g*d+d).map(a=>e.jsxs(R,{children:[e.jsx(p,{align:"center",children:a.name}),e.jsx(p,{align:"center",children:a.address}),e.jsx(p,{align:"center",children:a.status}),e.jsx(p,{align:"center",children:e.jsx(B,{color:"primary",onClick:()=>h(`/master/branch/edit/${a.id}`),children:e.jsx(be,{})})}),e.jsx(p,{align:"center",children:e.jsx(B,{color:"error",onClick:()=>J(a),children:e.jsx(oe,{})})})]},a.id))})]})}),e.jsx(je,{component:"div",count:m.length,page:g,rowsPerPage:d,onPageChange:U,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:z}),e.jsx(j,{mt:2}),e.jsxs(ge,{open:b,onClose:S,children:[e.jsx(fe,{children:"Confirm Delete"}),e.jsxs(ve,{children:[e.jsxs("p",{children:["Are you sure you want to delete ",e.jsx("b",{children:f==null?void 0:f.name}),"?"]}),e.jsx(s,{fullWidth:!0,label:"Reason for Delete",value:v,onChange:a=>W(a.target.value),margin:"dense"})]}),e.jsxs(Ce,{children:[e.jsx(x,{onClick:S,color:"secondary",children:"Cancel"}),e.jsx(x,{onClick:Y,color:"error",disabled:!v.trim(),children:"Delete"})]})]}),e.jsx(_e,{anchor:"right",open:$,onClose:O,children:e.jsxs(j,{p:3,width:300,display:"flex",flexDirection:"column",gap:2,children:[e.jsx("h3",{children:"Filter Branches"}),e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{item:!0,xs:12,children:e.jsx(s,{label:"Branch Name",variant:"outlined",fullWidth:!0,value:C,onChange:a=>I(a.target.value)})}),e.jsx(t,{item:!0,xs:12,md:12,children:e.jsxs(Se,{fullWidth:!0,children:[e.jsx(me,{children:"Status"}),e.jsxs(ye,{value:_,onChange:a=>A(a.target.value),label:"Status",children:[e.jsx(F,{value:"Active",children:"Active"}),e.jsx(F,{value:"Inactive",children:"Inactive"}),e.jsx(F,{value:"Cancelled",children:"Cancelled"})]})]})})]}),e.jsxs(j,{mt:2,display:"flex",justifyContent:"space-between",children:[e.jsx(x,{variant:"outlined",color:"secondary",onClick:K,children:"Reset"}),e.jsx(x,{variant:"contained",onClick:H,children:"Apply Filter"})]})]})})]})}const q=[{label:"Option 1",value:"1"},{label:"Option 2",value:"2"},{label:"Option 3",value:"3"}],Fe=[{label:"Active",value:"1"},{label:"InActive",value:"2"}],Pe=()=>{const{id:h}=ae(),l=k(),[r,m]=c.useState({username:"",firstName:"",email:"",creditCard:"",mobile:"",password:"",confirmPassword:"",branch_option:null});c.useEffect(()=>{fetch(`/api/branches/${h}`).then(n=>n.json()).then(n=>{const d=q.find(i=>i.value===n.branch_option);m({...n,branch_option:d||null})})},[h]);const o=n=>{m({...r,[n.target.name]:n.target.value})},g=n=>{var i;n.preventDefault();const d={...r,branch_option:((i=r.branch_option)==null?void 0:i.value)||""};fetch(`/api/branches/${h}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}).then(()=>l("/master/branch"))};return e.jsxs("div",{children:[e.jsx("h2",{children:"Edit Branch"}),e.jsxs("form",{onSubmit:g,children:[e.jsxs(t,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(t,{item:!0,md:6,xs:12,lg:3,children:e.jsx(s,{fullWidth:!0,name:"branch_code",value:r.branch_code,onChange:o,label:"Code",required:!0})}),e.jsx(t,{item:!0,md:6,xs:12,lg:3,children:e.jsx(s,{fullWidth:!0,name:"branch_name",value:r.branch_name,onChange:o,label:"Name",required:!0})}),e.jsx(t,{item:!0,md:6,xs:12,lg:3,children:e.jsx(s,{fullWidth:!0,type:"email",name:"branch_email",value:r.branch_email,onChange:o,label:"Email"})}),e.jsx(t,{item:!0,md:6,xs:12,lg:3,children:e.jsx(s,{fullWidth:!0,type:"number",name:"branch_pincode",value:r.branch_pincode,onChange:o,label:"Pincode",required:!0})})]}),e.jsxs(t,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(t,{item:!0,md:6,xs:12,lg:3,children:e.jsx(s,{fullWidth:!0,name:"branch_mobile",value:r.branch_mobile,onChange:o,label:"Contact",required:!0})}),e.jsx(t,{item:!0,md:6,xs:12,lg:3,children:e.jsx(P,{options:q,getOptionLabel:n=>n.label,value:r.branch_option,onChange:(n,d)=>m({...r,branch_option:d}),renderInput:n=>e.jsx(s,{...n,label:"Select State",variant:"outlined",fullWidth:!0,required:!0})})}),e.jsx(t,{item:!0,md:6,xs:12,lg:3,children:e.jsx(s,{fullWidth:!0,name:"branch_address",value:r.branch_address,onChange:o,label:"Address",required:!0})}),e.jsx(t,{item:!0,md:6,xs:12,lg:3,children:e.jsx(P,{options:Fe,getOptionLabel:n=>n.label,value:r.branch_option,onChange:(n,d)=>m({...r,branch_option:d}),renderInput:n=>e.jsx(s,{...n,label:"Select Status",variant:"outlined",fullWidth:!0,required:!0})})})]}),e.jsxs(x,{variant:"contained",color:"success",type:"submit",sx:{mr:2},children:[e.jsx(L,{children:"forward"}),e.jsx(N,{sx:{pl:1,textTransform:"capitalize"},children:"Update"})]}),e.jsx(x,{variant:"contained",color:"secondary",onClick:()=>l("/master/branch"),children:"Back"})]})]})},ke=se("div")(({theme:h})=>({margin:"30px",[h.breakpoints.down("sm")]:{margin:"16px"},"& .breadcrumb":{marginBottom:"15px",[h.breakpoints.down("sm")]:{marginBottom:"16px"}}}));function ta(){return e.jsxs(ke,{children:[e.jsx(j,{className:"breadcrumb",children:e.jsx(ne,{routeSegments:[{name:"Master",path:"/master"},{name:"Branch",path:"/master/branch"}]})}),e.jsx(Be,{spacing:3,children:e.jsx(te,{children:e.jsxs(re,{children:[e.jsx(D,{path:"/",element:e.jsx(we,{})}),e.jsx(D,{path:"add",element:e.jsx(De,{})}),e.jsx(D,{path:"edit/:id",element:e.jsx(Pe,{})})]})})})]})}export{ta as default};
